{% raw %}{% extends "account/base.html" %}
{% load i18n %}

{% block head_title %}{% translate "2FA Setup" %}{% endblock head_title %}
{% block title %}{% translate "Set Up Two-Factor Authentication" %}{% endblock title %}
{% block subtitle %}
  {% translate "Keep your account secure by requiring a second factor when logging in and performing sensitive operations." %}
{% endblock subtitle %}

{% block content %}
  <h2 class="text-2xl font-extrabold text-gray-900">{% translate "Step 1" %}</h2>
  <p class="mt-2 text-sm text-gray-600">
    {% translate "Scan the QR code below with a token generator of your choice (e.g., Google Authenticator) or manually type the secret key into your authenticator app." %}
  </p>

  <img src="{{ totp_svg_data_uri }}" alt="{{ form.secret }}" class="mt-1 mx-auto"/>
  <p class="font-mono font-bold text-sm text-gray-600 text-center tracking-widest">{{ form.secret }}</p>

  <h2 class="mt-8 text-2xl font-extrabold text-gray-900">{% translate "Step 2" %}</h2>
  <p class="my-2 text-sm text-gray-600">
    {% translate "Input the token generated by your authenticator app." %}
  </p>

  <form method="POST" class="space-y-6" action="{% url 'mfa_activate_totp' %}?next={{ next }}">
    {% include "account/non_field_errors.html" %}

    <div>
      <div class="mt-1">
        <input id="{{ form.code.id_for_label }}" name="{{ form.code.html_name }}"
               type="{{ form.code.field.widget.input_type }}" inputmode="numeric" pattern="[0-9]*"
               autocomplete="one-time-code" required
               class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        {{ form.code.errors }}
      </div>
    </div>

    <button type="submit"
            class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
      {% translate "Verify" %}
    </button>

    {% csrf_token %}
  </form>
{% endblock %}{% endraw %}
